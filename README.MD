# Weather Block Plugin

Un plugin WordPress personnalisÃ© qui ajoute un bloc Gutenberg pour afficher la mÃ©tÃ©o basÃ©e sur la gÃ©olocalisation de l'utilisateur.

## FonctionnalitÃ©s

-   ğŸŒ¤ï¸ Bloc Gutenberg personnalisÃ© pour afficher la mÃ©tÃ©o
-   ğŸ“ DÃ©tection automatique de la gÃ©olocalisation de l'utilisateur
-   ğŸ’¾ Cache des donnÃ©es mÃ©tÃ©o en base de donnÃ©es (Ã©vite les appels API rÃ©pÃ©tÃ©s)
-   ğŸ”„ Mise en cache quotidienne des donnÃ©es
-   âš ï¸ Gestion des erreurs (gÃ©olocalisation refusÃ©e, API indisponible)
-   ğŸ¨ Interface utilisateur moderne et responsive

## PrÃ©requis

-   WordPress 5.0+
-   PHP 7.4+
-   ClÃ© API WeatherAPI.com

## Installation

### Ã‰tape 1: Obtenir une clÃ© API

1. CrÃ©ez un compte gratuit sur [WeatherAPI.com](https://www.weatherapi.com/)
2. RÃ©cupÃ©rez votre clÃ© API depuis votre tableau de bord

### Ã‰tape 2: Structure des fichiers

CrÃ©ez la structure de dossiers suivante dans `/wp-content/plugins/weather-block/`:

```
weather-block/
â”œâ”€â”€ weather-block.php (fichier principal)
â”œâ”€â”€ README.md
â”œâ”€â”€ assets/
â”‚   â”œâ”€â”€ js/
â”‚   â”‚   â”œâ”€â”€ editor.js
â”‚   â”‚   â””â”€â”€ frontend.js
â”‚   â””â”€â”€ css/
â”‚       â”œâ”€â”€ style.css
â”‚       â””â”€â”€ editor.css
â””â”€â”€ languages/ (optionnel)
```

### Ã‰tape 3: Configuration de l'API

1. Ouvrez le fichier `weather-block.php`
2. Trouvez la ligne suivante dans la fonction `fetch_weather_from_api()`:
    ```php
    $api_key = 'YOUR_API_KEY';
    ```
3. Remplacez `'YOUR_API_KEY'` par votre vraie clÃ© API WeatherAPI

### Ã‰tape 4: Activation du plugin

1. Connectez-vous Ã  votre administration WordPress
2. Allez dans **Extensions** â†’ **Extensions installÃ©es**
3. Trouvez "Weather Block Plugin" et cliquez sur **Activer**
4. Le plugin crÃ©era automatiquement la table de cache en base de donnÃ©es

## Utilisation

1. Ã‰ditez une page ou un article avec l'Ã©diteur Gutenberg
2. Cliquez sur le bouton **+** pour ajouter un bloc
3. Recherchez "Weather Display" ou "Bloc MÃ©tÃ©o"
4. Ajoutez le bloc Ã  votre contenu
5. Publiez votre page

Sur le frontend, le bloc :

-   Demandera automatiquement l'autorisation de gÃ©olocalisation
-   Affichera la mÃ©tÃ©o actuelle si l'autorisation est accordÃ©e
-   Affichera un message d'erreur si l'autorisation est refusÃ©e

## Base de donnÃ©es

Le plugin crÃ©e une table `wp_weather_cache` avec la structure suivante :

-   `id` : Identifiant unique
-   `location_key` : ClÃ© MD5 des coordonnÃ©es
-   `weather_data` : DonnÃ©es mÃ©tÃ©o en JSON
-   `date_cached` : Date de mise en cache
-   `created_at` : Timestamp de crÃ©ation

## DÃ©pannage

### Le bloc ne s'affiche pas

-   VÃ©rifiez que votre clÃ© API est correctement configurÃ©e
-   VÃ©rifiez les logs d'erreur WordPress

### Erreur "Impossible de rÃ©cupÃ©rer les donnÃ©es mÃ©tÃ©o"

-   VÃ©rifiez votre clÃ© API WeatherAPI
-   VÃ©rifiez que votre serveur peut faire des appels HTTP sortants

### La gÃ©olocalisation ne fonctionne pas

-   Le site doit Ãªtre en HTTPS pour que la gÃ©olocalisation fonctionne
-   L'utilisateur doit autoriser la gÃ©olocalisation dans son navigateur

## Licence

Ce plugin est sous licence GPL v2 ou ultÃ©rieure.

## Support

Pour tout problÃ¨me ou question, crÃ©ez une issue sur le repository GitHub.
